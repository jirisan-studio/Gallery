---
import { getGalleryPosts } from "../lib/contentful";

// 1. Contentfulì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
const posts = await getGalleryPosts();
---

<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>ë‚˜ì˜ ë“œë¡  ê°¤ëŸ¬ë¦¬</title>
  </head>
  <body class="bg-slate-900 text-white min-h-screen p-6 font-sans">
    
    <header class="max-w-6xl mx-auto mb-12 pt-10 text-center">
      <h1 class="text-4xl md:text-5xl font-extrabold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-emerald-400">
        ğŸš My Drone Gallery
      </h1>
      <p class="text-slate-400 text-lg">ì§€ë¦¬ì‚°ì˜ ì•„ë¦„ë‹¤ìš´ í’ê²½ì„ ê¸°ë¡í•©ë‹ˆë‹¤.</p>
    </header>

    <!-- ê°¤ëŸ¬ë¦¬ ë¦¬ìŠ¤íŠ¸ -->
    <div class="max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
      {posts.map((post) => {
        // âœ¨ [í•µì‹¬ ìˆ˜ì •] ì´ë¯¸ì§€ ì£¼ì†Œ ì•ì— 'https:' ë¶™ì—¬ì£¼ê¸°
        let imgUrl = null;
        
        // Contentful ë°ì´í„° êµ¬ì¡°ì— ë”°ë¼ í•„ë“œ ì°¾ê¸° (coverImage, image, media ë“±)
        const imageField = post.fields.coverImage || post.fields.image || post.fields.media;

        if (imageField?.fields?.file?.url) {
          imgUrl = imageField.fields.file.url;
          // ì£¼ì†Œê°€ //ë¡œ ì‹œì‘í•˜ë©´ https:ë¥¼ ë¶™ì—¬ì¤Œ
          if (imgUrl.startsWith('//')) {
            imgUrl = 'https:' + imgUrl;
          }
        }

        return (
          <article class="bg-slate-800 rounded-2xl overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1 border border-slate-700 group">
            
            <!-- ì´ë¯¸ì§€ ì˜ì—­ -->
            <div class="aspect-video bg-slate-700 relative overflow-hidden">
              {imgUrl ? (
                <img 
                  src={imgUrl} 
                  alt={post.fields.title} 
                  class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                />
              ) : (
                <div class="flex items-center justify-center h-full text-slate-500">
                  ì´ë¯¸ì§€ ì—†ìŒ
                </div>
              )}
            </div>

            <!-- í…ìŠ¤íŠ¸ ì˜ì—­ -->
            <div class="p-6">
              <h2 class="text-xl font-bold mb-3 text-slate-100 leading-tight">
                {post.fields.title}
              </h2>
              
              <div class="flex flex-wrap gap-2 mt-4">
                {/* ìœ íŠœë¸Œ ë§í¬ê°€ ìˆìœ¼ë©´ ë²„íŠ¼ í‘œì‹œ */}
                {post.fields.youtubeUrl && (
                  <a href={post.fields.youtubeUrl} target="_blank" class="inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-lg transition-colors">
                    ğŸ“º ì˜ìƒ ë³´ê¸°
                  </a>
                )}
              </div>
            </div>
          </article>
        );
      })}
    </div>

    <footer class="mt-20 text-center text-slate-500 text-sm pb-10">
      - Made by Jirisan Studio -
    </footer>

  </body>
</html>